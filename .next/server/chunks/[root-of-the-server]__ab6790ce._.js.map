{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jehan/Desktop/react%20projects/BinaryBandits_hackelite2.0/src/app/lib/db.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\ndeclare global {\r\n  var _mongooseConn: Promise<typeof mongoose> | undefined;\r\n}\r\n\r\nexport async function connectToDB() {\r\n  const uri = process.env.MONGODB_URI;\r\n  if (!uri) {\r\n    throw new Error(\"MONGODB_URI is not set\");\r\n  }\r\n\r\n  if (!global._mongooseConn) {\r\n    global._mongooseConn = mongoose\r\n      .connect(uri, { dbName: process.env.MONGODB_DB || undefined })\r\n      .then((m: typeof mongoose) => {\r\n        return m;\r\n      });\r\n  }\r\n  return global._mongooseConn;\r\n}\r\n\r\nexport default connectToDB;\r\n"],"names":[],"mappings":";;;;AAAA;;AAMO,eAAe;IACpB,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;IACnC,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI,CAAC,OAAO,aAAa,EAAE;QACzB,OAAO,aAAa,GAAG,yGAAA,CAAA,UAAQ,CAC5B,OAAO,CAAC,KAAK;YAAE,QAAQ,QAAQ,GAAG,CAAC,UAAU,IAAI;QAAU,GAC3D,IAAI,CAAC,CAAC;YACL,OAAO;QACT;IACJ;IACA,OAAO,OAAO,aAAa;AAC7B;uCAEe","debugId":null}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jehan/Desktop/react%20projects/BinaryBandits_hackelite2.0/src/app/models/User.ts"],"sourcesContent":["import mongoose, { Schema, InferSchemaType, models, model } from \"mongoose\";\r\n\r\nconst UserSchema = new Schema(\r\n  {\r\n    email: { type: String, required: true, unique: true, index: true },\r\n    passwordHash: { type: String, required: true },\r\n    name: { type: String, required: false },\r\n    avatarUrl: { type: String },\r\n    role: { type: String, enum: [\"user\", \"admin\"], default: \"user\", index: true },\r\n    banned: { type: Boolean, default: false },\r\n    provider: { type: String, enum: [\"credentials\", \"google\"], default: \"credentials\" },\r\n    providerId: { type: String },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\nexport type UserDoc = InferSchemaType<typeof UserSchema> & { _id: mongoose.Types.ObjectId };\r\n\r\nexport default (models.User as mongoose.Model<UserDoc>) || model<UserDoc>(\"User\", UserSchema);\r\n"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,aAAa,IAAI,yGAAA,CAAA,SAAM,CAC3B;IACE,OAAO;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;QAAM,OAAO;IAAK;IACjE,cAAc;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC7C,MAAM;QAAE,MAAM;QAAQ,UAAU;IAAM;IACtC,WAAW;QAAE,MAAM;IAAO;IAC1B,MAAM;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAQ;SAAQ;QAAE,SAAS;QAAQ,OAAO;IAAK;IAC5E,QAAQ;QAAE,MAAM;QAAS,SAAS;IAAM;IACxC,UAAU;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAe;SAAS;QAAE,SAAS;IAAc;IAClF,YAAY;QAAE,MAAM;IAAO;AAC7B,GACA;IAAE,YAAY;AAAK;uCAKN,AAAC,yGAAA,CAAA,SAAM,CAAC,IAAI,IAAgC,CAAA,GAAA,yGAAA,CAAA,QAAK,AAAD,EAAW,QAAQ","debugId":null}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jehan/Desktop/react%20projects/BinaryBandits_hackelite2.0/src/app/lib/auth.ts"],"sourcesContent":["import { getIronSession } from \"iron-session\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nexport interface SessionData {\r\n  user?: {\r\n    id: string;\r\n    email: string;\r\n    role: \"user\" | \"admin\";\r\n    name?: string;\r\n  };\r\n}\r\n\r\nconst defaultSession: SessionData = {};\r\n\r\nexport async function getSession() {\r\n  const sessionSecret = process.env.SESSION_SECRET;\r\n  \r\n  if (!sessionSecret) {\r\n    throw new Error(\"SESSION_SECRET environment variable is required. Please add it to your .env.local file.\");\r\n  }\r\n\r\n  const session = await getIronSession<SessionData>(await cookies(), {\r\n    password: sessionSecret,\r\n    cookieName: \"pathfinder-session\",\r\n    cookieOptions: {\r\n      secure: process.env.NODE_ENV === \"production\",\r\n      httpOnly: true,\r\n      maxAge: 60 * 60 * 24 * 7, // 7 days\r\n    },\r\n  });\r\n\r\n  if (!session.user) {\r\n    session.user = defaultSession.user;\r\n  }\r\n\r\n  return session;\r\n}\r\n\r\nexport async function logout() {\r\n  const session = await getSession();\r\n  session.destroy();\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAWA,MAAM,iBAA8B,CAAC;AAE9B,eAAe;IACpB,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc;IAEhD,IAAI,CAAC,eAAe;QAClB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,UAAU,MAAM,CAAA,GAAA,kJAAA,CAAA,iBAAc,AAAD,EAAe,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD,KAAK;QACjE,UAAU;QACV,YAAY;QACZ,eAAe;YACb,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK,KAAK;QACzB;IACF;IAEA,IAAI,CAAC,QAAQ,IAAI,EAAE;QACjB,QAAQ,IAAI,GAAG,eAAe,IAAI;IACpC;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,UAAU,MAAM;IACtB,QAAQ,OAAO;AACjB","debugId":null}},
    {"offset": {"line": 206, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jehan/Desktop/react%20projects/BinaryBandits_hackelite2.0/src/app/lib/debug.ts"],"sourcesContent":["// Debugging utilities for authentication\r\n\r\nexport const DEBUG = process.env.NODE_ENV === \"development\";\r\n\r\nexport function debugLog(message: string, data?: unknown) {\r\n  if (DEBUG) {\r\n    console.log(`[AUTH DEBUG] ${message}`, data ? data : \"\");\r\n  }\r\n}\r\n\r\nexport function debugError(message: string, error?: unknown) {\r\n  if (DEBUG) {\r\n    console.error(`[AUTH ERROR] ${message}`, error ? error : \"\");\r\n  }\r\n}\r\n\r\nexport function formatApiError(error: unknown): string {\r\n  if (error instanceof Error) {\r\n    return error.message;\r\n  }\r\n  \r\n  if (typeof error === \"string\") {\r\n    return error;\r\n  }\r\n  \r\n  if (error && typeof error === \"object\" && \"message\" in error) {\r\n    return String(error.message);\r\n  }\r\n  \r\n  return \"An unexpected error occurred\";\r\n}\r\n\r\n// Log authentication events for debugging\r\nexport function logAuthEvent(event: string, details?: unknown) {\r\n  if (DEBUG) {\r\n    console.log(`[AUTH EVENT] ${event}`, details ? details : \"\");\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,yCAAyC;;;;;;;;AAElC,MAAM,QAAQ,oDAAyB;AAEvC,SAAS,SAAS,OAAe,EAAE,IAAc;IACtD,wCAAW;QACT,QAAQ,GAAG,CAAC,CAAC,aAAa,EAAE,SAAS,EAAE,OAAO,OAAO;IACvD;AACF;AAEO,SAAS,WAAW,OAAe,EAAE,KAAe;IACzD,wCAAW;QACT,QAAQ,KAAK,CAAC,CAAC,aAAa,EAAE,SAAS,EAAE,QAAQ,QAAQ;IAC3D;AACF;AAEO,SAAS,eAAe,KAAc;IAC3C,IAAI,iBAAiB,OAAO;QAC1B,OAAO,MAAM,OAAO;IACtB;IAEA,IAAI,OAAO,UAAU,UAAU;QAC7B,OAAO;IACT;IAEA,IAAI,SAAS,OAAO,UAAU,YAAY,aAAa,OAAO;QAC5D,OAAO,OAAO,MAAM,OAAO;IAC7B;IAEA,OAAO;AACT;AAGO,SAAS,aAAa,KAAa,EAAE,OAAiB;IAC3D,wCAAW;QACT,QAAQ,GAAG,CAAC,CAAC,aAAa,EAAE,OAAO,EAAE,UAAU,UAAU;IAC3D;AACF","debugId":null}},
    {"offset": {"line": 246, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jehan/Desktop/react%20projects/BinaryBandits_hackelite2.0/src/app/api/auth/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { z } from \"zod\";\r\nimport bcrypt from \"bcryptjs\";\r\nimport connectToDB from \"@/app/lib/db\";\r\nimport User from \"@/app/models/User\";\r\nimport { getSession } from \"@/app/lib/auth\";\r\nimport { debugLog, debugError } from \"@/app/lib/debug\";\r\n\r\nconst LoginSchema = z.object({\r\n  email: z.string().email(),\r\n  password: z.string().min(6),\r\n});\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    debugLog(\"Login attempt started\");\r\n    \r\n    await connectToDB();\r\n    const json = await req.json().catch(() => ({}));\r\n    const parsed = LoginSchema.safeParse(json);\r\n    \r\n    if (!parsed.success) {\r\n      debugError(\"Login validation failed\", parsed.error.format());\r\n      return NextResponse.json({ error: \"Invalid input data\" }, { status: 400 });\r\n    }\r\n    \r\n    const { email, password } = parsed.data;\r\n    debugLog(\"Looking up user\", { email });\r\n\r\n    const user = await User.findOne({ email });\r\n    if (!user || user.banned) {\r\n      debugError(\"User not found or banned\", { email, found: !!user, banned: user?.banned });\r\n      return NextResponse.json({ error: \"Invalid credentials\" }, { status: 401 });\r\n    }\r\n\r\n    const ok = await bcrypt.compare(password, user.passwordHash);\r\n    if (!ok) {\r\n      debugError(\"Password mismatch\", { email });\r\n      return NextResponse.json({ error: \"Invalid credentials\" }, { status: 401 });\r\n    }\r\n\r\n    const session = await getSession();\r\n    session.user = { \r\n      id: String(user._id), \r\n      email: user.email, \r\n      role: user.role as \"user\" | \"admin\", \r\n      name: user.name || undefined \r\n    };\r\n    await session.save();\r\n    \r\n    debugLog(\"Login successful\", { email, role: user.role });\r\n    return NextResponse.json({ ok: true });\r\n  } catch (error) {\r\n    debugError(\"Login error\", error);\r\n    return NextResponse.json({ error: \"Internal server error\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAEA,MAAM,cAAc,oKAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC3B,OAAO,oKAAA,CAAA,IAAC,CAAC,MAAM,GAAG,KAAK;IACvB,UAAU,oKAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC;AAC3B;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,CAAA,GAAA,4HAAA,CAAA,WAAQ,AAAD,EAAE;QAET,MAAM,CAAA,GAAA,yHAAA,CAAA,UAAW,AAAD;QAChB,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QAC7C,MAAM,SAAS,YAAY,SAAS,CAAC;QAErC,IAAI,CAAC,OAAO,OAAO,EAAE;YACnB,CAAA,GAAA,4HAAA,CAAA,aAAU,AAAD,EAAE,2BAA2B,OAAO,KAAK,CAAC,MAAM;YACzD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAqB,GAAG;gBAAE,QAAQ;YAAI;QAC1E;QAEA,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,OAAO,IAAI;QACvC,CAAA,GAAA,4HAAA,CAAA,WAAQ,AAAD,EAAE,mBAAmB;YAAE;QAAM;QAEpC,MAAM,OAAO,MAAM,8HAAA,CAAA,UAAI,CAAC,OAAO,CAAC;YAAE;QAAM;QACxC,IAAI,CAAC,QAAQ,KAAK,MAAM,EAAE;YACxB,CAAA,GAAA,4HAAA,CAAA,aAAU,AAAD,EAAE,4BAA4B;gBAAE;gBAAO,OAAO,CAAC,CAAC;gBAAM,QAAQ,MAAM;YAAO;YACpF,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,MAAM,KAAK,MAAM,mIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,UAAU,KAAK,YAAY;QAC3D,IAAI,CAAC,IAAI;YACP,CAAA,GAAA,4HAAA,CAAA,aAAU,AAAD,EAAE,qBAAqB;gBAAE;YAAM;YACxC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,MAAM,UAAU,MAAM,CAAA,GAAA,2HAAA,CAAA,aAAU,AAAD;QAC/B,QAAQ,IAAI,GAAG;YACb,IAAI,OAAO,KAAK,GAAG;YACnB,OAAO,KAAK,KAAK;YACjB,MAAM,KAAK,IAAI;YACf,MAAM,KAAK,IAAI,IAAI;QACrB;QACA,MAAM,QAAQ,IAAI;QAElB,CAAA,GAAA,4HAAA,CAAA,WAAQ,AAAD,EAAE,oBAAoB;YAAE;YAAO,MAAM,KAAK,IAAI;QAAC;QACtD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,IAAI;QAAK;IACtC,EAAE,OAAO,OAAO;QACd,CAAA,GAAA,4HAAA,CAAA,aAAU,AAAD,EAAE,eAAe;QAC1B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF","debugId":null}}]
}